<!DOCTYPE html>
<html lang="en">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0" />
  <title>Home Assistant Google Drive Backup</title>

  <!-- CSS  -->
  <link href="static/css/icons.css?version=0.100.0" rel="stylesheet">
  <link href="static/css/materialize.css?version=0.100.0" type="text/css" rel="stylesheet" media="screen,projection" />
  <link href="static/css/colpick.css?version=0.100.0" type="text/css" rel="stylesheet" media="screen,projection" />
  <link href="theme?version=0.100.0" id="theme" type="text/css" rel="stylesheet" media="screen,projection" />
  <link href="static/css/static.css?version=0.100.0" type="text/css" rel="stylesheet" media="screen,projection" />
  <link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet">
  <link rel="icon" type="image/png" href="static/images/favicon.png?version=0.100.0">
  <script src="static/js/jquery.js?version=0.100.0"></script>
  <script src="static/js/markdown-it.min.js?version=0.100.0"></script>
  <script src="static/js/clipboard.min.js?version=0.100.0"></script>
  <script src="static/js/materialize.js?version=0.100.0"></script>
  <script src="static/js/colpick.js?version=0.100.0"></script>
  <script src="static/js/init.js?version=0.100.0"></script>
  <script src="static/js/scripts.js?version=0.101.0"></script>
  <script src="static/js/settings.js?version=0.100.0"></script>
  <script src="static/js/restore.js?version=0.100.0"></script>
  <script src="static/js/moment.js?version=0.100.0"></script>
  <script type="text/javascript">
    $(document).ready(function () {
      // Needed to make modal dialogs work.
      $('#deletemodal').modal();
      $('#uploadmodal').modal();
      $('#deletemodal').modal();
      $('#restoremodal').modal();
      $('#retainmodal').modal();
      $('#snapshotmodal').modal();
      $('#settings_modal').modal({
        dismissible: false
      });
      $('#details_modal').modal();
      $('#help_modal').modal();
      $('#bug_modal').modal();

      // Every 5 seconds, refresh the metrics form the server.
      window.setInterval(refreshstats, 5000);
      refreshstats();

      $('.tooltipped').tooltip();
      $('.collapsible').collapsible();
      $('.sidenav').sidenav();

      var elems = document.querySelectorAll('.dropdown-trigger');
      var instances = M.Dropdown.init(elems, { 'constrainWidth': false });

      var clipboard = new ClipboardJS('.copyable');
      
      clipboard.on('success', function(e) {
          console.info('Action:', e.action);
          console.info('Text:', e.text);
          console.info('Trigger:', e.trigger);

          e.clearSelection();
          M.toast({html: "Copied! Now go to GitHub"});
      });

      clipboard.on('error', function(e) {
          console.error('Action:', e.action);
          console.error('Trigger:', e.trigger);
      });
    });
  </script>
</head>

<body>
  <div id="deletemodal" class="modal">
    <div class="modal-content">
      <h4>Are you sure?</h4>
      <p id="delete_text"></p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="danger-button modal-close waves-effect waves-light btn" id="delete_drive">Delete in Google
        Drive</a>
      <a href="#!" class="danger-button modal-close waves-effect waves-light btn" id="delete_ha">Delete in HA</a>
      <a href="#!" class="danger-button modal-close waves-effect waves-light btn" id="delete_both">Delete Everywhere</a>
      <a href="#!" class="modal-close waves-effect waves-light btn-flat" id="delete_cancel">Cancel</a>
    </div>
  </div>
  <div id="snapshotmodal" class="modal">
    <div class="modal-content">
      <h4>New Snapshot</h4>
      <p>Create a new snapshot immediately, using the settings you've configured for snapshots (eg full vs partial,
        password protection, etc). Optionally, you can set the name you'd like to use for this snapshot and indicate if
        you'd
        like it to be kept indefinitely in Home Assistant or Google Drive. These options will only apply to this one-off
        snapshot.</p>
      <form>
        <div class="row">
          <div class="input-field col s12">
            <i class="material-icons prefix">label_outline</i>
            <input type="text" id="snapshot_name_one_off" name="snapshot_name_one_off" class="validate"
              onkeyup="snapshotNameOneOffExample()" />
            <label for="snapshot_name_one_off">Snapshot Name</label>
            <span class="helper-text">The name to use for this snapshot, or leave it blank to use the default naming
              scheme. Optionally you can use template variables,<a target="_blank"
                href="https://github.com/sabeechen/hassio-google-drive-backup#can-i-give-snapshots-a-different-name">see
                here</a> for a list of all
              available options. Your snapshots name will look something like: <br /><span
                id="snapshot_name_example_one_off"></span>
          </div>
        </div>
        <div class="row" style="margin-left: 20px;">
          <div class="col s12">
            <label>
              <input type="checkbox" name="retain_drive_one_off" id="retain_drive_one_off"
                class="filled-in checkbox-ha" />
              <span>Keep indefinitely in Google Drive</span>
            </label>
            <br />
            <label>
              <input type="checkbox" name="retain_ha_one_off" id="retain_ha_one_off" class="filled-in checkbox-ha" />
              <span>Keep indefinitely in Home Assistant</span>
            </label>
          </div>
        </div>
      </form>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-light btn-flat" id="create_snapshot_button"
        onclick="doNewSnapshot(); return false;">Create Snapshot</a>
      <a href="#!" class="modal-close waves-effect waves-light btn-flat" id="cancel_snapshot">Cancel</a>
    </div>
  </div>
  <div id="retainmodal" class="modal">
    <div class="modal-content">
      <h4>Keep this snapshot around indefinitely?</h4>
      <p id="retain_text">
        Select where you'd like the snapshots kept indefinitely. It won't get deleted automatically and won't count
        toward the maximum number of snapshots you've configured to keep in Google Drive or Home Assistant. To delete it
        you'll either need to select "Delete" from the snapshot's menu or come back to this dialog and unckeck the
        options below to let it get automatically cleaned up (after a few minutes).
      </p>
      <form>
        <label>
          <input type="checkbox" name="notify_for_stale_snapshots" id="retain_drive" class="filled-in checkbox-ha" />
          <span>Keep indefinitely in Google Drive</span>
        </label>
        <br />
        <label>
          <input type="checkbox" name="notify_for_stale_snapshots" id="retain_ha" class="filled-in checkbox-ha" />
          <span>Keep indefinitely in Home Assistant</span>
        </label>
      </form>
    </div>
    <div class="modal-footer">
      <a href="#!" class="danger-button modal-close waves-effect waves-light btn" id="do_retain_button">Save</a>
      <a href="#!" class="modal-close waves-effect waves-light btn-flat" id="delete_cancel">Cancel</a>
    </div>
  </div>
  <div id="uploadmodal" class="modal">
    <div class="modal-content">
      <h4>Upload this snapshot to Home Assistant</h4>
      <p>Are you sure you'd like to upload this snapshot back to Home Assistant? The snapshot will be downloaded from Google
        Drive, and after that you'll be able to restore it.</p>
      <p><b>Note:</b> The snapshot you upload from Google Drive will be kept indefinitely in Home Assistant until you
        delete it manually. You can thange this by selecting "Never Delete" and unckecking "Keep indefinitely in Home
        Assistant" from the snapshot's action menu after its uploaded.</p>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-light btn-flat" id="do_upload_button">Upload Snapshot</a>
      <a href="#!" class="modal-close waves-effect waves-light btn-flat" id="upload_cancel">Cancel</a>
    </div>
  </div>
  <div id="restoremodal" class="modal">
    <div class="modal-content">
      <h4>Restore this snapshot?</h4>
      <p>Please confirm you'd like to restore this snapshot. This process is irreversible.</p>
      <ul class="browser-default">
        <li>Changes you've made since the snapshot was created will be permanently lost.</li>
        <li>Home Assistant and this add-on will be unresponsive until it is finished setting back up, which in some
          cases can take hours.</li>
        <li>If the snapshot doesn't have this add-on in it, you may need to reinstall the add-on</li>
      </ul>
      <div id="restore_password_div">
        <p>
          This snapshot is protected with a password. Please enter it to allow the snapshot to be restored.
        </p>
        <form class="col s12" method="get" id="restore_form">
          <div class="row">
            <div class="input-field col s12 m6 l3">
              <i class="material-icons prefix">vpn_key</i>
              <input type="password" autocomplete="new-password" id="restore_password" name="restore_password"
                class="validate" />
              <label for="restore_password">Password</label>
              <span class="helper-text">The password you used to create this snapshot.</span>
            </div>
          </div>
      </div>
      <div class="row" style="margin-bottom: 5px;">
        <div class="col s12">
          <label>
            <input type="checkbox" name="partial_restore" id="partial_restore" class="filled-in checkbox-ha"
              onchange="toggleSlide(this, 'restore_partial_details');" />
            <span>Restore only part of this snapshot</span>
            <br />
            <span class="helper-text">Choose which folders and add-on you'd like to restore from this snapshot.</span>
          </label>
        </div>
      </div>
      <div class="row" id="restore_partial_details" style="display: none">
        <div class="col s11 offset-s1">
          <div class="row">
            <div class="input-field col s12">
              <label class="checkbox-label">
                <input type="checkbox" name="restore_homeassistant" id="restore_homeassistant"
                  class="filled-in checkbox-ha" checked />
                <span>Home Assistant <span id="restore_homeassistant_version" class="helper-text"></span></span>
                <br />
                <span class="helper-text">Restore Home Assistant</span>
              </label>
            </div>
          </div>
          <div class="row" style="margin-bottom: 0px">
            <div class="col s12">
              <p style="font-weight: bold;">Folders</p>
              <ul style="margin-bottom: 0px; margin-top: 0px">
                <li class="indented-li">
                  <label>
                    <input settings_ignore="true" class="restore_folder_checkbox" type="checkbox"
                      name="restore_folder_homeassistant" id="restore_folder_homeassistant"
                      class="filled-in checkbox-ha" checked />
                    <span class="checkbox-label">Home Assistant Configuration</span>
                    <br />
                    <span class="helper-text">Restore the files and folders from your Home Assistant config
                      directory, eg configuration.yaml</span>
                  </label>
                </li>
                <li class="indented-li">
                  <label class="checkbox-label">
                    <input class="restore_folder_checkbox" type="checkbox" name="restore_folder_ssl"
                      id="restore_folder_ssl" class="filled-in checkbox-ha" checked />
                    <span class="checkbox-label">SSL</span>
                    <br />
                    <span class="helper-text">Restore your "/ssl" directory, where your certfile and keyfile
                      are typically stored.</span>
                  </label>
                </li>
                <li class="indented-li">
                  <label class="checkbox-label">
                    <input class="restore_folder_checkbox" type="checkbox" name="restore_folder_share"
                      id="restore_folder_share" class="filled-in checkbox-ha" checked />
                    <span class="checkbox-label">Share</span>
                    <br />
                    <span class="helper-text">Restore your "/share" directory.</span>
                  </label>
                </li>
                <li class="indented-li">
                  <label class="checkbox-label">
                    <input class="restore_folder_checkbox" type="checkbox" name="restore_folder_addons"
                      id="restore_folder_addons" class="filled-in checkbox-ha" checked />
                    <span class="checkbox-label">Local Addons</span>
                    <br />
                    <span class="helper-text">Restore your local addons directory. This directory will be empty
                      unless you use it for add-on development.</span>
                  </label>
                </li>
              </ul>
            </div>
          </div>
          <div class="row">
            <div class="col s12">
              <p style="font-weight: bold;">Addons</p>
              <ul id="restore_addons">

              </ul>
            </div>
          </div>
        </div>
      </div>
      </form>
    </div>
    <div class="modal-footer">
      <a href="#!" class="waves-effect waves-light btn-flat orange darken-4 white-text" id="do_restore_button">Restore
        Snapshot</a>
      <a href="#!" class="modal-close waves-effect waves-light btn-flat" id="restore_cancel">Cancel</a>
    </div>
  </div>

  <div id="snapshot-template" style="display: none">
    <div class="snapshot-ui">
      <div class="row" style="margin-bottom: 10px; margin-top: 10px;">
        <div class="col s1 valign-wrapper"><i class="large material-icons" style="font-size: 30px;">archive</i></div>
        <div class="col s11">
          <div>
            <span id="name" class="left truncate"></span>
            <span class="right" style="font-weight: bold;">
              <span id="status"></span>
              <i class="material-icons small tooltipped" id="status-help" style="font-size: 15px; vertical-align: top"
                data-position="left" data-tooltip="error">help</i>
            </span>
            <br />
            <span class="left">Size: <span id="size"></span></span>
            <br />
            <a class='dropdown-trigger btn right ha-blue waves-effect' href='#' data-target='action_dropdown'
              id="action_dropdown_button" style="display: none;">
              <i class="material-icons medium left">keyboard_arrow_down</i>
              Actions
            </a>
            <br />
            <a href="#" onclick="showDetails(this);return false;" id="status-details"><i class="material-icons left"
                style="margin-right: 3px; font-size: 15px;">info</i></a>
            <i class="material-icons left icon-protected tooltipped" data-position="right"
              data-tooltip="This snapshot is password protected" style="margin-right: 3px; font-size: 15px;">vpn_key</i>
            <i class="material-icons left icon-retain tooltipped" data-position="right"
              data-tooltip="This snapshot will be kept indefinitely until you delete it."
              style="margin-right: 3px; font-size: 15px;">lock</i>
            <i class="material-icons left tooltipped icon-warn-delete yellow-text text-darken-4" data-position="right"
              data-tooltip="" style="margin-right: 3px; font-size: 15px;">warning</i>
          </div>
          <ul id='action_dropdown' class='dropdown-content'>
            <li id="delete_option">
              <a href="#!" id="delete_link" data-target="deletemodal" class="modal-trigger tooltipped"
                data-position="left" data-tooltip="Deletes the snapshot from Home Assistant, Google Drive, or both."
                onClick="confirmDeleteSnapshot(this);return false;">
                <i class="material-icons left" style="font-size: 25px">delete_forever</i>Delete
              </a>
            </li>
            <li id="download_option">
              <a href="#!" id="download_link" class="tooltipped" data-position="left"
                data-tooltip="Save the snapshot archive to your computer."
                onClick="downloadSnapshot(this);return false;">
                <i class="material-icons left" style="font-size: 25px">file_download</i>Download
              </a>
            </li>
            <li class="divider" tabindex="-1"></li>
            <li id="restore_option">
              <a href="#!" onclick="restoreClick(this)" id="restore_link" class="tooltipped" data-position="left"
                data-tooltip="Restore the snapshot, overwriting your current configuration with this archive's.">
                <i class="material-icons left" style="font-size: 25px">input</i>Restore
              </a>
            </li>
            <li id="upload_option">
              <a href="#!" id="upload_link" data-target="uploadmodal" class="modal-trigger tooltipped"
                data-position="left"
                data-tooltip="Upload the snapshot from Google Drive to Home Assistant.  <br/>You'll need to do this if you want to restore the snapshot."
                onClick="uploadSnapshot(this);return false;">
                <i class="material-icons left" style="font-size: 25px">file_upload</i>Upload
              </a>
            </li>
            <li id="retain_option">
              <a href="#!" id="retain_link" class="tooltipped" data-position="left"
                data-tooltip="Keep this snapshot indefinitely until you manually delete it."
                onClick="retainSnapshot(this);return false;">
                <i class="material-icons left" style="font-size: 25px">lock</i>Never Delete
              </a>
            </li>
          </ul>
        </div>
      </div>
      <div class="divider">
      </div>
    </div>
  </div>
  <div id="settings_modal" class="modal modal-fixed-footer">
    <div class="modal-content">
      <h4>Add-on Settings</h4>
      <p>Settings take effect right after saving them. If you enable or disable SSL, you may need to go to a different
        address to access the UI after the settings are saved. See the <a
          href="https://github.com/sabeechen/hassio-google-drive-backup#configuration-options" target="_blank">GitHub
          Readme</a> for more help with settings.</p>
      <div class="row">
        <form class="col s12" method="get" id="settings_form">
          <div class="row">
            <div class="input-field col m6 s12">
              <i class="material-icons prefix">computer</i>
              <input type="number" id="max_snapshots_in_hassio" name="max_snapshots_in_hassio" min="0"
                class="validate" />
              <label for="max_snapshots_in_hassio">Snapshots in Home Assistant</label>
              <span class="helper-text">The maximum number of snapshots to keep locally in Home Assistant, or 0 to
                disable cleanup of old snapshots entirely.</span>
            </div>
            <div class="input-field col m6 s12">
              <i class="material-icons prefix">cloud_upload</i>
              <input type="number" id="max_snapshots_in_google_drive" name="max_snapshots_in_google_drive" min="0"
                class="validate" />
              <label for="max_snapshots_in_google_drive">Snapshots in Google Drive</label>
              <span class="helper-text">The maximum number of snapshots to keep remotely in Google Drive, or 0 to
                disable cleanup of old snapshots entirely.</span>
            </div>
          </div>
          <div class="row">
            <div class="input-field col m6 s12">
              <i class="material-icons prefix">date_range</i>
              <input type="number" id="days_between_snapshots" name="days_between_snapshots" min="0" class="validate" />
              <label for="days_between_snapshots">Days between snapshots</label>
              <span class="helper-text">The number of days between snapshots, or 0 to disable automatic snapshot
                creation.</span>
            </div>
            <div class="input-field col m6 s12">
              <i class="material-icons prefix">alarm_on</i>
              <input type="text" id="snapshot_time_of_day" name="snapshot_time_of_day" pattern="^[0-2]\d:[0-5]\d$"
                class="validate" />
              <label for="snapshot_time_of_day">Snapshot time of day</label>
              <span class="helper-text">The time of day when snapshots should be taken in the form 'HH:mm' (24 hour
                clock).</span>
            </div>
          </div>
          <div class="row">
            <div class="input-field col m6 s12">
              <i class="material-icons prefix">vpn_key</i>
              <input type="password" autocomplete="new-password" id="snapshot_password" name="snapshot_password"
                class="validate" onkeyup="checkForSecret()" />
              <label for="snapshot_password">Password</label>
              <span class="helper-text">When set, creates snapshots protected by a password. This password will be
                required by Home Assistant when restoring the snapshot. Leave blank to require no password. You can specify a
                password from your secrets.yaml by using the syntax "!secret your_secret_key".</span>
            </div>
            <div class="input-field col m6 s12" id="password_renter_block">
              <i class="material-icons prefix">vpn_key</i>
              <input type="password" autocomplete="new-password" id="snapshot_password_reenter"
                name="snapshot_password_reenter" settings_ignore='true' class="validate" onkeyup="checkForSecret()" />
              <label for="snapshot_password_reenter">Re-enter password</label>
              <span class="helper-text">Re-enter your new password to ensure it matches.</span>
            </div>
          </div>
          <div class="row">
            <div class="input-field col s12">
              <i class="material-icons prefix">label_outline</i>
              <input type="text" id="snapshot_name" name="snapshot_name" class="validate"
                onkeyup="snapshotNameExample()" />
              <label for="snapshot_name">Snapshot Name Template</label>
              <span class="helper-text">The template to use for naming new snapshot. <a target="_blank"
                  href="https://github.com/sabeechen/hassio-google-drive-backup#can-i-give-snapshots-a-different-name">See
                  here</a> for a list of all
                available options, your snapshots names will look something like: <br /><span
                  id="snapshot_example"></span>
            </div>
          </div>
          <div class="row">
            <div class="col s12">
              <label>
                <input type="checkbox" name="specify_snapshot_folder" id="specify_snapshot_folder"
                  class="filled-in checkbox-ha" onchange="chooseFolderChanged();" />
                <span>Manually specify the snapshot folder</span>
                <br />
                <span class="helper-text">Specify manually which folder snapshots should be uploaded into in Google
                  Drive. <span class="hide-for-custom-creds">Once this setting is saved,
                    you'll be prompted to select a folder from your Google Drive.</span> If disabled, the addon will
                  automatically create a folder in your My Drive
                  whenever its needed.</span><span id="current_folder_span"><a id=current_folder_link target="_blank">
                    Click here</a> to see the folder currently being used.</span>
              </label>
              <br />
              <div id="choose_folder_controls">
                <div class="hide-for-custom-creds">
                  <a href="#!" id="choose_folder_button" onclick="chooseSnapshotFolder()"
                    class="waves-effect waves-light btn-flat ha-blue" id="save_settings"
                    style="margin-left: 20px; margin-top: 10px;">Choose Folder</a> <span
                    class="hide-for-custom-creds helper-text" style="vertical-align: middle;"> Note: This link takes you
                    to an external domain.</span>
                </div>
                <div class="hide-for-default-creds">
                  <div class="input-field col s11 offset-s1">
                    <i class="material-icons prefix">folder_open</i>
                    <input type="text" settings_ignore='true' id="settings_specify_folder_id"
                      name="settings_specify_folder_id" class="validate" />
                    <label for="settings_specify_folder_id">Snapshot Folder ID</label>
                    <span class="helper-text">The Google Drive ID of the folder you'd like to upload snapshots into. You
                      can get this id by navigating to the folder in <a href="https://drive.google.com">Google Drive</a>
                      and copying it out of the URL. It should be a long sequence of characters at the end of the URL.
                      For example if the URL for my folder is
                      <a target="_blank"
                        href="https://drive.google.com/drive/folders/1el4ZWcE0xdkIu_Yt_2kxk36qE7K5O188">https://drive.google.com/drive/folders/1el4ZWcE0xdkIu_Yt_2kxk36qE7K5O188</a>,
                      then the Drive ID is
                      1el4ZWcE0xdkIu_Yt_2kxk36qE7K5O188</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col m6 s12">
              <label>
                <input type="checkbox" name="notify_for_stale_snapshots" id="notify_for_stale_snapshots"
                  class="filled-in checkbox-ha" />
                <span>Enable Staleness Notifications</span>
                <br />
                <span class="helper-text">When there is a problem with the snapshots, show a persistant notification in
                  the Home Assistant interface.</span>
              </label>
            </div>
            <div class="col m6 s12">
              <label>
                <input type="checkbox" name="enable_snapshot_stale_sensor" id="enable_snapshot_stale_sensor"
                  class="filled-in checkbox-ha" />
                <span>Enable Snapshot Stale Sensor</span>
                <br />
                <span class="helper-text">Publishes a sensor, binary_sensor.snapshots_stale, indicating if there is a
                  problem backing up or creating snapshots.</span>
              </label>
            </div>
          </div>
          <div class="row">
            <div class="col m6 s12">
              <label>
                <input type="checkbox" name="enable_snapshot_state_sensor" id="enable_snapshot_state_sensor"
                  class="filled-in checkbox-ha" />
                <span>Enable Snapshot State Sensor</span>
                <br />
                <span class="helper-text">Publishes a sensor, sensor.snapshot_state, with the status of existing
                  snapshots.</span>
              </label>
            </div>
            <div class="col m6 s12">
              <label>
                <input type="checkbox" name="send_error_reports" id="send_error_reports"
                  class="filled-in checkbox-ha" />
                <span>Send Error Reports</span>
                <br />
                <span class="helper-text">Sends information about errors to a database maintained by developer. This
                  helps him identify problems with new releases and provide better help messages.</span>
              </label>
            </div>
          </div>
          <div class="row">
            <div class="col m6 s12">
              <label>
                <input type="checkbox" name="confirm_multiple_deletes" id="confirm_multiple_deletes"
                  class="filled-in checkbox-ha" />
                <span>Confirm before large deletes</span>
                <br />
                <span class="helper-text">When disabled, the add-on will NOT stop and ask for confirmation before
                  deleting more than one snapshot. Disabling this is dangerous because accidental misconfiguration can
                  cause you to lose your backed-up snapshot history.</span>
              </label>
            </div>
            <div class="col m6 s12">
              <label>
                <input type="checkbox" name="enable_drive_upload" id="enable_drive_upload"
                  class="filled-in checkbox-ha" />
                <span>Enable Google Drive Upload</span>
                <br />
                <span class="helper-text">When disabled, new snapshots will still be created in Home Assistant but will
                  not be uploaded to Google Drive.</span>
              </label>
            </div>
          </div>
          <div class="row">
            <div class="col s12">
              <label>
                <input type="checkbox" name="warn_for_low_space" id="warn_for_low_space"
                  class="filled-in checkbox-ha" />
                <span>Stop on low disk space</span>
                <br />
                <span class="helper-text">When enabled, the addon will stop creating snapshots and ask for you to take
                  action it thinks you don't have enough disk space. Disabling this is not recommended because
                  recovering from an exhausted disk can be very difficult.</span>
              </label>
            </div>
          </div>
          <div class="row">
            <div class="col s12">
              <label>
                <input type="checkbox" name="expose_extra_server" id="expose_extra_server" class="filled-in checkbox-ha"
                  onchange="toggleSlide(this, 'settings_server_details');" />
                <span id="expose_extra_server_label">Expose this web interface on an additional port</span>
                <br />
                <span class="helper-text" id="expose_extra_server_help">Expose this web interface on an additional port.
                  This isn't necessary unless you'd like to avoid accessing this web interface through <a
                    target="_blank"
                    href="https://www.home-assistant.io/blog/2019/04/15/hassio-ingress/">ingress</a>.</span>
              </label>
            </div>
          </div>
          <div class="row" id="settings_server_details" style="display: none">
            <div class="col s11 offset-s1">
              <label>
                <span class="helper-text">Use the options below to configure what kind of SSL and and authentication
                  you'd like to use for this webpage. By default this server is exposed on port 1627, but that can be
                  changed from the add-on installation page.</span>
              </label>
            </div>
            <div class="col s11 offset-s1">
              <div class="row">
                <div class="col s12">
                  <label>
                    <input type="checkbox" name="require_login" id="require_login" class="filled-in checkbox-ha" />
                    <span>Require Login</span>
                    <br />
                    <span class="helper-text">Makes you enter your Home Assistant credentials to login to this
                      webpage.</span>
                  </label>
                </div>
              </div>
              <div class="row">
                <div class="col s12">
                  <label>
                    <input type="checkbox" name="use_ssl" id="use_ssl" class="filled-in checkbox-ha"
                      onchange="toggleSlide(this, 'settings_ssl_details');" />
                    <span>Use SSL</span>
                    <br />
                    <span class="helper-text">Require SSL to access this web interface. You must already have SSL keys
                      configured to use this. Note that once this setting is changed, you'll need to navigate to the
                      new url
                      to continue using this webpage.</span>
                  </label>
                </div>
                <div class=" col s12 offset-s1 row" id="settings_ssl_details" style="display: none">
                  <div class="input-field col s12">
                    <i class="material-icons prefix">vpn_key</i>
                    <input type="text" id="certfile" name="certfile" class="validate" />
                    <label for="certfile">Certificate File</label>
                    <span class="helper-text">The path to your certificate file. If you use the default Let's
                      Encrypt settings, the default should be correct.</span>
                  </div>
                  <div class="input-field col s12">
                    <i class="material-icons prefix">vpn_key</i>
                    <input type="text" id="keyfile" name="keyfile" class="validate" />
                    <label for="keyfile">Key File</label>
                    <span class="helper-text">The path to your key file. If you use the default Let's Encrypt
                      settings, the default should be correct.</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col s12">
              <label>
                <input type="checkbox" settings_ignore='true' id="generational_enabled" name="generational_enabled"
                  class="filled-in checkbox-ha" onchange="toggleSlide(this, 'settings_gen_details');" />
                <span>Keep Generational Backups</span>
                <br />
                <span class="helper-text">Keeps older snapshots longer on daily, weekly, monthly, and yearly rotations
                  instead of just
                  deleting the oldest snapshots. When using this feature, its recommended that you keep "Days
                  Between Snapshots" at 1. <a
                    href="https://github.com/sabeechen/hassio-google-drive-backup/blob/master/hassio-google-drive-backup/GENERATIONAL_BACKUP.md"
                    target="_blank">See here</a> for a deeper explanation.</span>
              </label>
            </div>
            <div class="row" id="settings_gen_details" style="display: none">
              <div class="col s11 offset-s1">
                <div class="row">
                  <div class="input-field col m6 s12">
                    <i class="material-icons prefix">date_range</i>
                    <input type="number" id="generational_days" name="generational_days" min="0" class="validate" />
                    <label for="generational_days">Days</label>
                    <span class="helper-text">The number of daily snapshots to keep.</span>
                  </div>
                </div>
                <div class="row">
                  <div class="input-field col m6 s12">
                    <i class="material-icons prefix">date_range</i>
                    <input type="number" id="generational_weeks" name="generational_weeks" min="0" class="validate" />
                    <label for="generational_weeks">Weeks</label>
                    <span class="helper-text">The number of weeks of snapshots to keep.</span>
                  </div>
                  <div class="input-field col m6 s12">
                    <select class="browser-default" name="generational_day_of_week" id="generational_day_of_week">
                      <option value="mon" selected>Monday</option>
                      <option value="tue">Tuesday</option>
                      <option value="wed">Wednesday</option>
                      <option value="thu">Thursday</option>
                      <option value="fri">Friday</option>
                      <option value="sat">Saturday</option>
                      <option value="sun">Sunday</option>
                    </select>
                    <label class="helper-text">The day of the week when weekly snapshots will be kept.</label>
                  </div>
                </div>
                <div class="row">
                  <div class="input-field col m6 s12">
                    <i class="material-icons prefix">date_range</i>
                    <input type="number" id="generational_months" name="generational_months" min="0" class="validate" />
                    <label for="generational_months">Months</label>
                    <span class="helper-text">The number of months of snapshots to keep.</span>
                  </div>
                  <div class="input-field col m6 s12">
                    <input type="number" id="generational_day_of_month" value=1 name="generational_day_of_month" min="1"
                      max="31" class="validate" />
                    <label for="generational_day_of_month">Day of Month</label>
                    <span class="helper-text">The day of the month to keep monthly snapshots, from 1 to 31</span>
                  </div>
                </div>
                <div class="row">
                  <div class="input-field col m6 s12">
                    <i class="material-icons prefix">date_range</i>
                    <input type="number" id="generational_years" name="generational_years" min="0" class="validate" />
                    <label for="generational_years">Years</label>
                    <span class="helper-text">The number of years of snapshots to keep.</span>
                  </div>
                  <div class="input-field col m6 s12">
                    <input type="number" id="generational_day_of_year" value=1 name="generational_day_of_year" min="1"
                      max="365" class="validate" />
                    <label for="generational_day_of_year">Day of Year</label>
                    <span class="helper-text">The day of the year to keep yearly snapshots, from 1 to 365</span>
                  </div>
                </div>
                <div class="row">
                  <div class="col s12">
                    <label>
                      <input type="checkbox" id="generational_delete_early" name="generational_delete_early"
                        class="filled-in checkbox-ha" />
                      <span>Purge Old Snapshots Early</span>
                      <br />
                      <span class="helper-text">When checked, old snapshots that aren't part of any daily, weekly,
                        monthly, or yearly cycle you've configured will be deleted even if you haven't reached the
                        configured maxium number of snapshots in Google Drive/Home Assistant.</span>
                    </label>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col s12">
              <label>
                <input type="checkbox" settings_ignore="true" name="partial_snapshots" id="partial_snapshots"
                  class="filled-in checkbox-ha" onchange="toggleSlide(this, 'settings_partial_details');" />
                <span>Partial Snapshots</span>
                <br />
                <span class="helper-text">Partial snapshots allow you to selectively backup portions of your Home
                  Assistant configuration,
                  folder, and add-ons. Choose which parts of Home Assistant you'd like included in snapshots below.
                  New add-ons will be automatically included in snapshots unless you update these settings to
                  exclude them.</span>
              </label>
            </div>
          </div>
          <div class="row" id="settings_partial_details" style="display: none">
            <div class="col s11 offset-s1">
              <div class="row" style="margin-bottom: 0px">
                <div class="col s12">
                  <span style="font-weight: bold">Folders</span>
                  <ul>
                    <li class="indented-li">
                      <label>
                        <input class="filled-in settings_folder_checkbox" settings_ignore="true" type="checkbox"
                          name="folder_homeassistant" id="folder_homeassistant" checked />
                        <span class="checkbox-label">Home Assistant Configuration</span>
                        <br />
                        <span class="helper-text">Backup the files and folders from your Home Assistant config
                          directory, eg configuration.yaml</span>
                      </label>
                    </li>
                    <li class="indented-li">
                      <label class="checkbox-label">
                        <input class="filled-in settings_folder_checkbox" settings_ignore="true" type="checkbox"
                          name="folder_ssl" id="folder_ssl" checked />
                        <span class="checkbox-label">SSL</span>
                        <br />
                        <span class="helper-text">Backup your "/ssl" directory, where your certfile and keyfile
                          are typically stored.</span>
                      </label>
                    </li>
                    <li class="indented-li">
                      <label class="checkbox-label">
                        <input class="filled-in settings_folder_checkbox" settings_ignore="true" type="checkbox"
                          name="folder_share" id="folder_share" checked />
                        <span class="checkbox-label">Share</span>
                        <br />
                        <span class="helper-text">Backup your "/share" directory.</span>
                      </label>
                    </li>
                    <li class="indented-li">
                      <label class="checkbox-label">
                        <input class="filled-in settings_folder_checkbox" settings_ignore="true" type="checkbox"
                          name="folder_addons" id="folder_addons" checked />
                        <span class="checkbox-label">Local Addons</span>
                        <br />
                        <span class="helper-text">Backup your local addons directory. This directory will be empty
                          unless you use it for add-on development.</span>
                      </label>
                    </li>
                  </ul>
                </div>
              </div>
              <div class="row">
                <div class="col s12">
                  <span style="font-weight: bold;">Addons</span>
                  <ul id="settings_addons">

                  </ul>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col s12">
              <label>
                <span style="font-size: 15px;">Look and Feel</span>
                <br />
                <span class="helper-text">Configure how this web UI looks</span>
              </label>
            </div>
          </div>
          <div class="row">
            <div class="col s11 offset-s1 row">
              <div class="row">
                <div class="input-field col s6">
                  <i class="material-icons prefix">format_paint</i>
                  <a href="#!" class="waves-effect waves-light btn-flat" style="margin-left: 45px; margin-top: 10px"
                    onclick="showPallette(this)" id="background_color"></a>
                  <label style="transform: translateY(-20px) scale(0.8)">Background Color</label>
                  <span class="helper-text" style="margin-top: 10px">The background color of this interface. <a href="#"
                      onclick="revertColors();">Click here</a> to revert back to the default.</span>
                </div>
                <div class="input-field col s6">
                  <i class="material-icons prefix">format_paint</i>
                  <a href="#!" class="waves-effect waves-light btn-flat" style="margin-left: 45px; margin-top: 10px"
                    onclick="showPallette(this)" id="accent_color"></a>
                  <label style="transform: translateY(-20px) scale(0.8)">Accent Color</label>
                  <span class="helper-text" style="margin-top: 10px">The accent color of this interface (eg links,
                    buttons, and other elements you can interact with). <a href="#" onclick="revertColors();">Click
                      here</a> to revert back to the default.</span>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col s12">
              <label>
                <span style="font-size: 15px;">Networking Options</span>
                <br />
                <span class="helper-text">Configure timeouts and other options about how the add-on reaches Google
                  Drive</span>
              </label>
            </div>
          </div>
          <div class="row">
            <div class="col s11 offset-s1 row">
              <div class="input-field col m6 s12">
                <i class="material-icons prefix">timelapse</i>
                <input type="number" id="google_drive_timeout_seconds" name="google_drive_timeout_seconds" min="1"
                  class="validate" />
                <label for="google_drive_timeout_seconds">Google Drive Timeout</label>
                <span class="helper-text">The number of seconds the add-on should wait when connecting to or reading
                  from Google Drive's servers.</span>
              </div>
              <div class="input-field col m6 s12">
                <i class="material-icons prefix">cloud</i>
                <input type="text" id="alternate_dns_servers" name="alternate_dns_servers"
                  pattern="^([0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})(,[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3})*$"
                  class="validate" />
                <label for="alternate_dns_servers">Alternate DNS Servers</label>
                <span class="helper-text">When the add-on runs into trouble resolving Google Drive's IP Address, it will
                  use this comma-delimited list of DNS Servers as alternate sources for name resolution. The servers
                  must support TCP DNS lookups. The defaults are <a
                    href="https://developers.google.com/speed/public-dns/" target="_blank">Google's public DNS
                    servers</a>.</span>
              </div>
            </div>
            <div class="col s11 offset-s1 row">
              <div class="col m12 s12">
                <label>
                  <input type="checkbox" name="ignore_ipv6_addresses" id="ignore_ipv6_addresses"
                    class="filled-in checkbox-ha" />
                  <span>Ignore IPv6 Addresses</span>
                  <br />
                  <span class="helper-text">Ignore ipv6 Addresses for the purposes or DNS resolution. Some users have
                    had problems attempting to connect to Googles IPv6 servers because it is disabled on their
                    network.</span>
                </label>
              </div>
            </div>
            <div class="col s11 offset-s1 row">
              <div class="input-field col s12 m12 s12">
                <i class="material-icons prefix">cloud_queue</i>
                <input type="text" id="drive_ipv4" name="drive_ipv4"
                  pattern="^[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}$" class="validate" />
                <label for="drive_ipv4">Google Drive IP Address Override</label>
                <span class="helper-text">If you're having problems with reaching Google Drive, you can use this to
                  specify Google Drive's IP address manually and circumvent DNS lookup entirely. You can use a website
                  like <a target="_blank" href="https://www.xmyip.com/hostname-ip?hostname=www.googleapis.com">this
                    one</a> to lookup
                  what address will work for www.googleapis.com.</span>
              </div>
            </div>
            <div class="col s11 offset-s1 row">
              <div class="input-field col s12 m12 s12">
                <i class="material-icons prefix">refresh</i>
                <input type="text" id="max_sync_interval_seconds" name="max_sync_interval_seconds"
                  pattern="^([ ]*([0-9]*[.])?[0-9]+[ ]*(seconds|second|secs|sec|s|minutes|minute|mins|min|m|hours|hour|hr|h|days|day|d)?[ ,]*)*$" class="validate" />
                <label for="drive_ipv4">Sync Interval</label>
                <span class="helper-text">
                  How often the addon should check Home Assistant and Google Drive for snapshots.  
                  The addon will still sync more frequently when it starts, creates a new snapshot, 
                  or encounters errors.  This can be any duration of time expressed as hours, minutes,
                  and seconds.  Examples: '1 hour', '30 minutes', '1 hour, 30 minutes, 10 seconds', etc.</span>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div class="modal-footer" style="min-height: 56px; height: auto;">
      <div class="left valign-wrapper red darken-4 white-text default-hidden" id="settings_error_div"
        style="margin: 6px; padding-left: 16px; padding-right: 16px; min-height: 36px; vertical-align: middle">
        <span id="settings_error" style="vertical-align: middle;">
          Some configuration is invalid, check for red errors up above.
        </span>
      </div>

      <a href="#!" class="waves-effect waves-light btn-flat" id="save_settings" onClick="saveSettings()">Save</a>
      <a href="#!" class="waves-effect waves-light btn-flat" onclick="handleCloseSettings()" id="save_cancel">Cancel</a>
    </div>
  </div>
  <div id="details_modal" class="modal">

    <div class="modal-content">
      <h4> <i class="material-icons"
          style="font-size: 50px; padding-right: 10px; vertical-align: middle">info_outline</i><span>Snapshot
          Details</span></h4>
      <p class="detail-node">
        <span class="left-align" style="font-weight: bold; padding: 5px;">Name:</span> <span id="details_name"></span>
      </p>
      <p class="detail-node">
        <span class="left-align" style="font-weight: bold; padding: 5px;">Date:</span> <span id="details_date"></span>
      </p>
      <p class="detail-node">
        <span class="left-align" style="font-weight: bold; padding: 5px;">Home Assistant Version:</span> <span
          id="details_ha_version"></span></p>
      <p class="detail-node">
        <span class="left-align" style="font-weight: bold; padding: 5px;">Type:</span> <span id="details_type"></span>
      </p>
      <p class="detail-node">
        <span class="left-align" style="font-weight: bold; padding: 5px;">Password:</span> <span
          id="details_password"></span></p>
      <div id="details_folders_and_addons">
        <p style="font-weight: bold; padding: 5px; margin-bottom: 0px; padding-bottom: 0px">Folders:</p>
        <ul style="margin-left: 15px" id="details_folders"></ul>
        <p style="font-weight: bold; padding: 5px; margin-bottom: 0px; padding-bottom: 0px">Addons:</p>
        <ul style="margin-left: 15px" id="details_addons"></ul>
      </div>
      <div id="details_upload_reminder">
        <p style="font-style: italic">
          To see folders and addons included in this snapshot, you must upload it to Home Assistant by selecting
          "Actions" -> "Upload".
        </p>
      </div>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-light btn-flat" id="save_cancel">Close</a>
    </div>
  </div>
  <div id="bug_modal" class="modal modal-fixed-footer">
    <div class="modal-content">
      <h4> <i class="material-icons"
          style="font-size: 50px; padding-right: 10px; vertical-align: middle">bug_report</i><span>Report an Issue</span>
      </h4>
      <p class="detail-node">
        Looks like you ran into a problem that you want to report to the developer.  Getting a lot of detail about what you 
        ran into can really help him figure things out.  To make gathering that easy for you and the developer, follow these instructions:
        <ul class="browser-default">
          <li>Click <a href="#!" id="copyButtonId" data-id="@item.Type" class="copyable"
            data-clipboard-action="copy" data-clipboard-target="div#bug_details"><i style="vertical-align: middle;" class="material-icons">content_copy</i>Copy Details</a> to copy the details below to your clipboard.  This includes detail about your configuration, 
            any errors the addon found, and logs from Home Assistant, the Supervisor, and the addon.  This information will be
            very helpful to the developer who looks at your issue.</li>
          <li>Click <a target="_blank" href="https://github.com/sabeechen/hassio-google-drive-backup/issues/new?title=Please%20add%20a%20title&body=Copy%20the%20info%20from%20the%20previous%20page%20here"><i style="vertical-align: middle;" class="material-icons">open_in_new</i>Open Github</a>
             to open a new issue on Github and paste the text you copied there.  You can click "Preview" to make sure it looks right.</li>
          <li>Before submitting the issue, add in any information you think might help.  Consider including what you were doing that caused the error, a screenshot, etc.</li>
          <li>Click "Submit new issue" on Github to post the issue.  The developer will get back to you as fast as he can, but keep in mind that he maintains this project in his free time.</li>
        </ul>
      </p>
      <p>Here is a preview of the information you'll be providing:</p>
      <pre>
        <div id="bug_details" class="highlight-border" style="overflow-y: scroll; overflow-x: scroll;"></div>
      </pre>
    </div>
    <div class="modal-footer">
      <button id="copyButtonId" data-id="@item.Type"
      data-clipboard-action="copy" data-clipboard-target="div#bug_details" class="copyable btn waves-effect waves-light btn-flat"><i class="material-icons" style="vertical-align: middle; padding-right: 5px;">content_copy</i>Copy Details</button>
      <a target="_blank" href="https://github.com/sabeechen/hassio-google-drive-backup/issues/new?title=Please%20add%20a%20title&body=Copy%20the%20info%20from%20the%20previous%20page%20here" class="waves-effect waves-light btn-flat"><i class="material-icons" style="vertical-align: middle; padding-right: 5px;">open_in_new</i>Open Github</a>
      <a href="#!" class="modal-close waves-effect waves-light btn-flat">Close</a>
    </div>
  </div>
  <div id="help_modal" class="modal">
    <div class="modal-content">
      <h4> <i class="material-icons"
          style="font-size: 50px; padding-right: 10px; vertical-align: middle">help_outline</i><span>Get Help</span>
      </h4>
      <p class="detail-node">
        Maybe this add-on isn't working or you just don't know what to do. You can resolve almost any issue by following
        these steps:
      </p>
      <ul class="browser-default">
        <li>
          <h6>Check the FAQ</h6>First check out the <a
            href="https://github.com/sabeechen/hassio-google-drive-backup#faq">add-on FAQ</a>.
          Reading documentation is boring, its true, but the developer spent a lot of time trying making them easy to
          read and follow. If you're lucky, your question is already answered there.
        </li>

        <li>
          <h6>Check the Forum</h6>Next, try checking the <a
            href="https://community.home-assistant.io/t/hass-io-add-on-hass-io-google-drive-backup/">add-on announcement
            forum post.</a> Your question might already be there, and if not its a good place to ask. If the developer
          can't answer your question, it might be that another user can help.
        </li>
        <li>
          <h6>Check the Logs</h6>This add-on makes its <a target="_blank" href="log?format=view">debug logs</a>
          available. They're pretty cryptic, but might give you some context for whats going wrong. Sometimes, an error
          only shows up in the Home Assistant supervisor logs, which you can get to from within Home Assistant by
          clicking "Supervisor" > "System" > "System Logs" > "Refresh".
        </li>
        <li>
          <h6>Restart Everything</h6>
          Restart the add-on. Restart Home Assistant. Reinstall the add-on. Technology loves to be restarted, its
          amazing how many problems it can solve.
        </li>
        <li>
          <h6>File an Issue</h6>If you don't want to ask something in front of the angry mobs on the internet, you can
          file an issue on the
          project GitHub <a onclick="bugReport()">Issue Tracker</a>,
          just click "new issue". The developer gets an email if make one of those, which he promises to try and help
          with. No question is stupid.
        </li>
        <li>
          <h6>Reach out Directly</h6>I put my name on this and I want it to work well for you. You can email me at <a
            href="mailto:stephen@beechens.com">stephen@beechens.com</a>
        </li>
      </ul>
      <p>Maybe what you're dealing with is of a more, <i>general</i> nature? Home Assistant has a lot of rough edges,
        but really anything can be frustrating.</p>
      <ul class="browser-default">
        <li>
          <h6>Take care of yourself</h6>
          Make sure you've had enough water to drink today. If you love coffee, it might be time to put on a new pot. If
          its late at night, now might be the time to hit the sack. Everything is more difficult when you're not at your
          best.
        </li>
        <li>
          <h6>Get a fresh perspective</h6>
          Take a walk, serously. Sometimes the mind gets so fixated on a problem that it can't think around it anymore.
          <a href="https://en.wikipedia.org/wiki/Rubber_duck_debugging">Explain your problem to a duck</a> and you
          might see the solution was obvious.
        </li>
        <li>
          <h6>Be realistic</h6>
          In a week you're unlikely to even remember this moment. Next year, you're going to be a different person, with
          a different mind. If you have the spare time to get frustrated at how your home automation system stores its
          backups, then whatever you've got going on in this moment is probably small potates. You've always been the
          one to decide how you react.
        </li>
      </ul>
    </div>
    <div class="modal-footer">
      <a href="#!" class="modal-close waves-effect waves-light btn-flat">That Helps</a>
      <a href="#!" class="modal-close waves-effect waves-light btn-flat">Nevermind</a>
    </div>
  </div>
  <div class='error' style='display:none' id="toast">You shouldn't see this</div>
  <header>
    <ul id="main_menu_dropdown" class="dropdown-content">
      <li><a onclick="newSnapshotClick(); return false;"><i class="material-icons left">add</i>Snapshot Now</a>
      </li>
      <li><a onclick="sync('error_card')"><i class="material-icons left">autorenew</i>Sync Now</a></li>
      <li><a class="open_drive_link" target="_blank"><i class="material-icons">cloud</i>Open Drive Snapshots</a></li>
      <li><a href="reauthenticate"><i class="material-icons">vpn_key</i>Reauthorize Google Drive</a></li>
      <li><a onclick="bugReport()"><i class="material-icons">bug_report</i>Report a bug</a></li>
    </ul>
    <ul id="main_menu_dropdown2" class="dropdown-content">
      <li><a onclick="newSnapshotClick(); return false;"><i class="material-icons left">add</i>Snapshot Now</a>
      </li>
      <li><a onclick="sync('error_card')"><i class="material-icons left">autorenew</i>Sync Now</a></li>
      <li><a class="open_drive_link" target="_blank"><i class="material-icons">cloud</i>Open Drive Snapshots</a></li>
      <li><a href="reauthenticate"><i class="material-icons">vpn_key</i>Reauthorize Google Drive</a></li>
      <li><a onclick="bugReport()"><i class="material-icons">bug_report</i>Report a bug</a></li>
    </ul>
    <nav class="non-ingress ha-blue" role="navigation">
      <div class="nav-wrapper">
        <a class="brand-logo">
          <img style="vertical-align: middle;" src="static/images/logo.png" width=40 height=40 />
          <span>Snapshots</span>
        </a>
        <a href="#" data-target="mobile-menu" class="sidenav-trigger"><i class="material-icons">menu</i></a>
        <ul class="right hide-on-med-and-down">
          <li>
            <a href="#!" onClick="loadSettings()">
              <i class="material-icons"
                style="display: inline; margin-right: 5px; vertical-align: bottom">settings</i>Settings
            </a>
          </li>
          <li>
            <a href="log?format=view" target="_blank">
              <i class="material-icons" style="display: inline; margin-right: 5px; vertical-align: bottom">code</i>Logs
            </a>
          </li>
          <li>
          <li>
            <a href="#!" class="modal-trigger" data-target="help_modal">
              <i class="material-icons" style="display: inline; margin-right: 5px; vertical-align: bottom">help</i>Get
              Help
            </a>
          </li>
          <li>
          <li>
            <a class="dropdown-trigger" href="#!" data-target="main_menu_dropdown2">
              Actions
              <i class="material-icons right">arrow_drop_down</i>
            </a>
          </li>
          </li>
        </ul>
      </div>
    </nav>
    <ul class="sidenav non-ingress" id="mobile-menu">
      <li><a href="#!" onClick="loadSettings()"><i class="material-icons">settings</i>Settings</a></li>
      <li><a href="log?format=view" target="_blank"><i class="material-icons">code</i>Logs</a></li>
      <li><a onclick="newSnapshotClick(); return false;"><i class="material-icons left">add</i>Snapshot Now</a>
      </li>
      <li><a onclick="sync()"><i class="material-icons left">autorenew</i>Sync Now</a></li>
      <li><a class="open_drive_link" target="_blank"><i class="material-icons">cloud</i>Open Drive Snapshots</a></li>
      <li><a href="reauthenticate"><i class="material-icons">vpn_key</i>Reauthorize Google Drive</a></li>
      <li><a href="#!" data-target="help_modal" class="modal-trigger"><i class="material-icons">help</i>Get Help</a>
      <li><a onclick="bugReport()"><i class="material-icons">bug_report</i>Report a bug</a></li>
    </ul>
    <div>

    </div>
    <div class="ingress-only ha-blue" style="width: 100%; height: 40px;">
      <a class="dropdown-trigger left waves-effect btn top-btn" href="#!" data-target="main_menu_dropdown">
        <i class="material-icons left">arrow_drop_down</i>
        Actions
      </a>
      <a href="#!" class="left btn waves-effect top-btn modal-trigger" data-target="help_modal">
        <i class="material-icons" style="display: inline; margin-right: 5px">help</i>
        <span style="vertical-align: top;">Get Help</span>
      </a>
      <a href="log?format=view" target="_blank" class="left btn waves-effect top-btn">
        <i class="material-icons" style="display: inline; margin-right: 5px">code</i>
        <span style="vertical-align: top;">Logs</span>
      </a>
      <a href="#!" onClick="loadSettings()" class="left waves-effect btn top-btn">
        <i class="material-icons" style="display: inline; margin-right: 5px">settings</i>
        <span style="vertical-align: top;">Settings</span>
      </a>
    </div>
  </header>
  <main>
    <div class="container">
      <div class="section">
        <div class="row default-hidden" id="error_card">
          <div class="col s12 m9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">sync_problem</i>
                  <span style="vertical-align: top;">Error while backing up</span>
                </span>
                <p>The add-on got the error below while trying to sync your snapshots. Some transient errors are
                  expected
                  (eg an upload could fail if the internet is down) but if this persist for more than a few minutes your
                  snapshots won't get backed up and the information you see on this page may be stale. If you file an
                  issue on GitHub with the link below, it could be helpful to provide the logs downloaded from the
                  "Download Logs" link below</p>
                <br />
                <p id="generic_error_title" style="white-space: pre-wrap;font-family: monospace;"></p>
                <div>
                  <a onclick="toggleLinkSlide(this, 'generic_error_details');" href="#!"><i class="material-icons"
                      style="padding-right: 10px; vertical-align: bottom;">arrow_drop_down</i> View Exception
                    Details</a>
                  <div id="generic_error_details" class="default-hidden"
                    style="padding-left: 10px; white-space: pre-wrap;font-family: monospace;">
                    <p>Below is the list of names and IP Addresses Google's API servers resolve to. Next to each is
                      the result from an attempt the add-on has made to ping the address. This may help in
                      determining if something in your network is blocking accesss to one of Google's API servers,
                      or if Google's API servers are having problems.</p>
                  </div>
                </div>
                <div class="card-action white-text">
                  <a id="error_github_search" href="#" target="_blank">Find similar issues</a>
                </div>
                <div class="card-action white-text">
                  <a id="error_github_link" onclick="bugReport()">File this issue on Github</a>
                </div>
                <div class="card-action white-text">
                  <a id="download_logs_link" href="log?format=download" target="_blank">Download logs</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card low_space" id="low_space">
          <div class="col s12 m9">
            <div class="card red darken-4 white-text">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">disc_full</i>
                  <span style="vertical-align: top;">Low Disc Space</span>
                </span>
                <p> It looks like you're low on disk space. The addon won't attempt to create a snapshot until you take
                  action or more space becomes available. It looks like your backup folder in Home Assistant is <b
                    id="data_pct_used"></b> full and only has <b id="data_space_remaining"></b> left so creating 
                    another snapshot runs the risk of exhausting the space available.  When Home Assistant runs out of 
                    disk space, it can stop responding and become very difficult to fix.  This addon can only estimate 
                    how big the the next snapshot will be based on your most recent one, it can't know how big the snapshot 
                    will be until its actually created.</p>
                  <p>To resolve this you can:</p>
                  <ul class="browser-default">
                    <li>Free up space in Home Assistant.  Addons like the <a target="_blank" href="https://www.home-assistant.io/addons/configurator/">Configurator</a> can help you see what files might be taking up space.</li>
                    <li>Make your snapshots smaller (see <a target="_blank"
                      href="https://github.com/sabeechen/hassio-google-drive-backup#will-this-fill-up-my-google-drive--why-are-my-snapshots-so-big">this
                      tip</a>).  You can also click the little <i class="material-icons"
                      style="display: inline; margin-right: 2px; vertical-align: middle; font-size: 15px">info</i> next to snapshots below to see which parts of them are taking up the most space.</li>
                      <li>Modify your <a href="#!" onclick="loadSettings()"><i class="material-icons"
                        style="display: inline; margin-right: 2px; vertical-align: middle; font-size: 15px">settings</i>add-on
                      settings</a> to store fewer snapshots in Home Assistant.</li>
                      <li>Delete existing snapshots from Home Assitant by clicking "Action" -> "Delete" on snapshots below.  Make sure you don't need them anymore of they're backed to Google Drive.</li>
                    <li>Modify your <a href="#!" onclick="loadSettings()"><i class="material-icons"
                      style="display: inline; margin-right: 2px; vertical-align: middle; font-size: 15px">settings</i>add-on
                      settings</a> and disable "Stop on low disc space".  This will make the addon stop checking disc usage, do so at your own peril.</li>
                    <li>Click "Create snapshot anyway" to bypass this warning just this one time.  This is useful if you're confident that the snapshot actually will fit in the available space.  Again, do so at your own peril.</li>
                  </ul>
                  <div class="card-action white-text">
                      <a href="#" onclick="sync('low_space'); return false;">Try Syncing Again</a>
                      <a href="#" onclick="skipLowSpaceWarning(); return false;">Create snapshot anyway</a>
                  </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card drive_full" id="drive_full_card">
          <div class="col s12 m9">
            <div class="card red darken-4 white-text">
              <div class="card-content white-text">

                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">disc_full</i>
                  <span style="vertical-align: top;">Google Drive is Full</span>
                </span>

                <p>Google Drive is full, backups can't continue until space is available. You can go to Google Drive's
                  <a href="https://drive.google.com/drive/quota">quota page</a> to see whats using up space in your
                  Google
                  Drive, but because that space is shared between several Google products (eg GMail, Google Photos) one
                  of
                  those products might be using the space instead. You can see your usage across all those products on
                  Google's <a href="https://drive.google.com/settings/storage">storage settings</a> page.</p>
                <p>To resolve this you can:</p>
                <ul class="browser-default">
                  <li>Free up space in Google Drive, GMail, or Google Photos by deleting things.</li>
                  <li>Modify your <a href="#!" onclick="loadSettings()"><i class="material-icons"
                        style="display: inline; margin-right: 2px; vertical-align: middle; font-size: 15px">settings</i>add-on
                      settings</a> to store fewer snapshots in Google Drive</li>
                  <li><a href="https://drive.google.com/settings/storage">Buy more storage</a> from Google</li>
                  <li>Make your snapshots smaller (see <a
                      href="https://github.com/sabeechen/hassio-google-drive-backup#will-this-fill-up-my-google-drive--why-are-my-snapshots-so-big">this
                      tip</a>)</li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card creds_bad" id="creds_bad_card">
          <div class="col s12 m9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">error</i>
                  <span style="vertical-align: top;">Couldn't Log in with Google</span>
                </span>
                <p>Google Drive rejected your credentials. Your snapshots will not be backed up until this is resolved.
                </p>
                <p>This can happen if:</p>
                <ul class="browser-default">
                  <li>You revoked the add-on's access in your Google account settings.</li>
                  <li>You recently changed your Google account password.</li>
                  <li>You haven't used your Google account for over 6 months.</li>
                  <li>The add-on's credentials changed, or Google changed them.</li>
                </ul>
                <p>To resolve this, you'll need to <a href="reauthenticate">authenticate</a> this add-on with Google
                  again. If that still doesn't help, you may need to update the add-on</p>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card delete_error" id="delete_error">
          <div class="col s12 m9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">delete_forever</i>
                  <span style="vertical-align: top;">Couldn't delete old snapshots in Home Assistant</span>
                </span>
                <p>
                  The add-on ran into an error (HTTP 400) trying to delete your oldest snapshot. This can happen
                  sometimes (especially if you just installed the add-on) when Home Assistant's cache of your existing snapshots
                  is out of sync. The add-on can't continue until this is resolved.
                </p>
                <p>To resolve this, you can try:</p>
                <ul class="browser-default">
                  <li>Refreshing your snapshots by going to the snapshot page in Home Assistant and clicking the refresh icon
                    in the top right.</li>
                  <li>Restarting the machine Home Assistant runs on.</li>
                </ul>
                <p>The add-on will retry periodically to check if the issue is resolved. To retry now, click "Try
                  Syncing Again" below. If the above doesn't help, please file an issue on <a onclick="bugReport()">GitHub</a>
                  to get more help.</p>
              </div>
              <div class="card-action white-text">
                <a href="#" onclick="sync('delete_error'); return false;">Try Syncing Again</a>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card google_dns" id="cant_reach_google">
          <div class="col s12 m12 l10">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">cloud_off</i>
                  <span style="vertical-align: top;">Couldn't Reach Google Drive (DNS error)</span>
                </span>
                <p>The add-on couldn't resolve Google Drive's server address. Snapshots can't be backed up
                  without being able to reach Google Drive.</p>
                <p>Please ensure:</p>
                <ul class="browser-default">
                  <li>The internet is working.</li>
                  <li>The server www.googleapis.com is reachable from your Home Assistant
                    machine. Some ad-blocking and firewall software (eg Ad Guard, Pihole, etc) can block this
                    addresses.<br />
                    <div style='padding: 5px'>
                      <a onclick="toggleLinkSlide(this, 'cant_reach_google_dns');" href="#!"><i class="material-icons"
                          style="padding-right: 10px; vertical-align: bottom;">arrow_drop_down</i> Show DNS info</a>
                      <div id="cant_reach_google_dns" class="default-hidden" style="padding-left: 10px">
                        <p>Below is the list of names and IP Addresses Google's API servers resolve to. Next to each is
                          the result from an attempt the add-on has made to ping the address. This may help in
                          determining if something in your network is blocking accesss to one of Google's API servers,
                          or if Google's API servers are having problems.</p>
                        <div class="dns_info row"></div>
                        <div class="divider"></div>
                      </div>
                    </div>
                  </li>
                </ul>

                <p>You can also try restarting this add-on, the supervisor, or Home Assistant.</p>
                <div class="card-action white-text">
                  <a href="#" onclick="sync('google_dns'); return false;">Try Syncing Again</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card google_timeout" id="google_timeout">
          <div class="col s12 m12 l9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">cloud_off</i>
                  <span style="vertical-align: top;">Google Drive Connection Timeout</span>
                </span>
                <p>The connection timed out or was closed unexpectedly while trying to communicate with Google Drive.
                  Snapshots can't be
                  backed up without being able to reach Google Drive reliably. This can happen transiently from time to
                  time and the
                  addon will continue to attempt to sync your snapshots. This problem almost always resolves itself
                  after some time.</p>
                <p>Please ensure:</p>
                <ul class="browser-default">
                  <li>The internet is working.</li>
                  <li>The server www.googleapis.com are reachable from your Home Assistant
                    machine. Some ad-blocking and
                    firewall software (eg Ad Guard, pi-hole, etc) can block or throttle traffic to this address.<br />
                    <div style='padding: 5px'>
                      <a onclick="toggleLinkSlide(this, 'cant_reach_google_dns_timeout');" href="#!"><i
                          class="material-icons"
                          style="padding-right: 10px; vertical-align: bottom;">arrow_drop_down</i> Show DNS info</a>
                      <div id="cant_reach_google_dns_timeout" class="default-hidden" style="padding-left: 10px">
                        <p>Below is the list of names and IP Addresses Google's API servers resolve to. Next to each is
                          the result from an attempt the add-on has made to ping the address. This may help in
                          determining if something in your network is blocking accesss to one of Google's API servers,
                          or if Google's API servers are having problems.</p>
                        <div class="dns_info row"></div>
                        <div class="divider"></div>
                      </div>
                    </div>
                  </li>
                </ul>
                <p>You can also try syncing again or restarting this add-on, the supervisor, or Home Assistant.</p>
                <div class="card-action white-text">
                  <a href="#" onclick="sync('google_timeout'); return false;">Try Syncing Again</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card google_cant_connect">
          <div class="col s12 m12 l9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">cloud_off</i>
                  <span style="vertical-align: top;">Can't Connect to Google Drive</span>
                </span>
                <p>Google Drive refused an attempt to connect with it. Snapshots can't be backed up without being able
                  to reach Google Drive.</p>
                <p>Please ensure:</p>
                <ul class="browser-default">
                  <li>The internet is working.</li>
                  <li>The server www.googleapis.com are reachable from your Home Assistant
                    machine. Some ad-blocking and
                    firewall software (eg Ad Guard, pi-hole, etc) can block or throttle traffic to this address.<br />
                    <div style='padding: 5px'>
                      <a onclick="toggleLinkSlide(this, 'cant_connect_google_dns');" href="#!"><i class="material-icons"
                          style="padding-right: 10px; vertical-align: bottom;">arrow_drop_down</i> Show DNS info</a>
                      <div id="cant_connect_google_dns" class="default-hidden" style="padding-left: 10px">
                        <p>Below is the list of names and IP Addresses Google's API servers resolve to. Next to each is
                          the result from an attempt the add-on has made to ping the address. This may help in
                          determining if something in your network is blocking accesss to one of Google's API servers,
                          or if Google's API servers are having problems.</p>
                        <div class="dns_info row"></div>
                        <div class="divider"></div>
                      </div>
                    </div>
                  </li>
                </ul>
                <p>You can also try syncing again or restarting this add-on, the supervisor, or Home Assistant.</p>
                <div class="card-action white-text">
                  <a href="#" onclick="sync('google_cant_connect'); return false;">Try Syncing Again</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card password_key_invalid">
          <div class="col s12 m12 l9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">vpn_key</i>
                  <span style="vertical-align: top;">Invalid Snapshot Password</span>
                </span>
                <p>The add-on couldn't find your snapshot password in your secrets.yaml file. Snapshots can't be created
                  until you either configure a valid password or remove it.</p>
                <p>This can happen if:</p>
                <ul class="browser-default">
                  <li>Your secrets.yaml file isn't present in your Home Assistant configuration directory</li>
                  <li>The password key isn't present in your secrets.yaml file.</li>
                </ul>
                <p>Please review your <a href="#!" onclick="loadSettings()"><i class="material-icons"
                      style="display: inline; margin-right: 2px; vertical-align: middle; font-size: 15px">settings</i>add-on
                    settings</a>to ensure you've set the snapshot password you intended, then sync again.</p>
                <div class="card-action white-text">
                  <a href="#" onclick="sync('password_key_invalid'); return false;">Try Syncing Again</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card snapshot_in_progress">
          <div class="col s12 m12 l9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">settings_backup_restore</i>
                  <span style="vertical-align: top;">Snapshot Already in Progress</span>
                </span>
                <p>The add-on couldn't create a snapshot on schedule because one is already in progress. Home Assistant can
                  only create one snapshot at a time. This can happen if:</p>
                <ul class="browser-default">
                  <li>The add-on was started while a snapshot was already in progress</li>
                  <li>A snapshot was started outside of the add-on, eg manually from the supervisor snapshots page.</li>
                </ul>
                <p>Typically you don't need to do anything to resolve this, as the add-on will pick up again once the
                  snapshot in progress finishes.
                  If you are certain no snapshot is in progress already or this error sticks around, you can try
                  restarting the addon or Home Assistant's host machine.</p>
                <div class="card-action white-text">
                  <a href="#" onclick="sync('snapshot_in_progress'); return false;">Try Syncing Again</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card multiple_deletes" id="google_timeout">
          <div class="col s12 m12 l9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">delete_forever</i>
                  <span style="vertical-align: top;">Attempting to Delete Multiple Snapshots</span>
                </span>
                <p>The add-on attempted to delete <span id="data_GoogleDrive">(?)</span> snapshot(s) from Google
                  Drive and <span id="data_HomeAssistant">(?)</span> snapshot(s) from Home Assistant.
                  Under normal circumstance, the add-on will only delete one snapshot at a time (the oldest).
                  This warning is produced to prevent the add-on from accidentally deleting your history of snapshots.
                  This is normal if you recently lowered the number of snapshots to keep in Google Drive or Home
                  Assistant.</p>
                <p>To resolve this you can:</p>
                <ul class="browser-default">
                  <li>Review the <a href="#!" onclick="loadSettings()"><i class="material-icons"
                        style="display: inline; margin-right: 2px; vertical-align: middle; font-size: 15px">settings</i>add-on
                      settings</a> and increase the number of snapshots you keep.</li>
                  <li>Click "Allow Deletion" below to permit these deletions to happen this one time.</li>
                  <li>Click "Never ask again" below to permit the deletes this time and in the future (not recommended)
                  </li>
                </ul>
                <div class="card-action white-text">
                  <a href="#" onclick="allowDeletion('false'); return false;">Allow Deletion</a>
                  <a href="#" onclick="allowDeletion('true'); return false;">Never Ask again</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card google_server_error" id="google_server_error">
          <div class="col s12 m9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">cloud_off</i>
                  <span style="vertical-align: top;">Google Server Error</span>
                </span>
                <p>Google returned a server error (HTTP code 500) while trying to backup your snapshots.</p>
                <p>This happens sometimes for reasons beyond anyone's control and almost always the problem goes away on
                  its own. The add-on will attempt uploading again soon, but you can also click "Try Syncing Again"
                  below to make it retry now.</p>
                <p>If this error keeps sticking around, you can try:</p>
                <ul class="browser-default">
                  <li>Making sure the internet is working fine.</li>
                  <li>Making sure you're able to log into your <a href="https://drive.google.com">Google Drive
                      account</a> and upload files without problems.</li>
                  <li>Reauthenting the add-on with Google Drive (click "ACTIONS" -> "Reauthorize Google Drive" up top)
                  </li>
                  <li>Restarting the add-on, Home Assistant, or the supervisor.</li>
                  <li>Reinstalling the add-on.</li>
                </ul>
                <div class="card-action white-text">
                  <a href="#" onclick="sync('google_server_error'); return false;">Try Syncing Again</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card google_session_expired" id="google_session_expired">
          <div class="col s12 m9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">cloud_off</i>
                  <span style="vertical-align: top;">Google Session Expired</span>
                </span>
                <p>Google returned a server error (HTTP code 404) while trying to upload your snapshots.</p>
                <p>In most cases, this indicates that your upload took too long to upload. According to Google's
                  documentation if an upload takes longer than a week then it will be forcibly cancelled and return this
                  error. This can happen if your internet is very slow or your snapshots are very large, however the 
                  developer of this addon suspects this can happen in more common circumstances. If the below options don't
                  help, please file an issue on <a onclick="bugReport()">GitHub</a> with as much
                  detail as you can stomach to help him look into it.
                </p>
                <p>If this error keeps sticking around, you can try:</p>
                <ul class="browser-default">
                  <li>Syncing again (if it hasn't already started) by clicking "Try Syncing Again" below.</li>
                  <li>Making sure you're able to log into your <a target="_blank" href="https://drive.google.com">Google
                      Drive
                      account</a> and upload files without problems.</li>
                  <li>Ensuring your internet connection is reasonably fast by doing a <a target="_blank"
                      href="https://www.google.com/search?q=speed+test">speed test</a></li>
                  <li>Making your snapshots smaller. Usually snapshots are large because of a huge sensor database. You
                    can keep a smaller history by setting up the <a target="_blank"
                      href="https://www.home-assistant.io/components/recorder/">recorder component</a> purge settings in
                    Home Assistant</li>
                  <li>Restarting the add-on, Home Assistant, or the supervisor.</li>
                  <li>Reinstalling the add-on.</li>
                </ul>
                <div class="card-action white-text">
                  <a href="#" onclick="sync('google_session_expired'); return false;">Try Syncing Again</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card existing_backup_folder" id="existing_backup_folder">
          <div class="col s12 m12 l9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">folder_special</i>
                  <span style="vertical-align: top;">Existing Backup Folder Found</span>
                </span>
                <p>The add-on found a snapshot folder named "<b><span id="data_existing_name"></span></b>" in Google
                  Drive that might already have snapshots
                  in it. This is normal if you've used this addon before, but you'll need to decide where snapshots
                  should go before this will start backing up again. <a id="data_existing_url" target="_blank">Click
                    here</a> to see the folder contents in Google Drive.</p>
                <p>To resolve this you can:</p>
                <ul class="browser-default">
                  <li>"Use the folder" and merge in snapshots from this Home Assistant instance. If this
                    instance has newer snapshots, then some of the snapshots in Google Drive might get deleted to make
                    room for these newer ones (this depends on your settings). You probably want this option if you just
                    reinstalled the addon.</li>
                  <li>"Choose a different folder" to store snapshots in, ignoring the existing folder. You probably want
                    his option if you have multiple Home Assistant instances that should all back up to their
                    own folder.</li>
                  <li>Or "create a new folder" to automatically create a folder and ignore the existing one. The new folder will be created
                    at the root of your My Drive.</li>
                </ul>
                <p>Note: If you run multiple instance of Home Assistant with this addon using the same Google
                  Drive account,
                  its recommended that you use a different folder for each instance. Otherwise they'll delete
                  eachother's
                  snapshots!</p>
                <div class="card-action white-text">
                  <a href="#" onclick="resolvefolder('true')">Use the folder</a>
                  <a href="#" onclick="chooseSnapshotFolder()">Choose a different folder</a>
                  <a href="#" onclick="resolvefolder('false')">Create a new folder</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card backup_folder_missing" id="backup_folder_missing">
          <div class="col s12 m12 l9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">folder_special</i>
                  <span style="vertical-align: top;">Please choose a backup folder</span>
                </span>
                <p class="hide-for-custom-creds">You've choosen to backup your snapshots to a folder of your choosing.
                  Click the link below to open a new window and select the folder in Google Drive you'd like to store
                  your snapshot in.</p>
                <p class="hide-for-default-creds">You've choosen to backup your snapshots to a folder of your choosing.
                  Please navigate to the addon settings to specify a folder to store snapshots in.</p>
                <ul class="browser-default">
                  <li>
                    <p>If you'd rather not specify the folder for uploads, please return to your <a href="#!"
                        onclick="loadSettings()"><i class="material-icons"
                          style="display: inline; margin-right: 2px; vertical-align: middle; font-size: 15px">settings</i>add-on
                        settings</a> and change your preference.</p>
                  </li>
                  <li>
                    Your snapshots in Home Assistant will be re-uploaded to the new folder. If you already have them in
                    an existing folder in Google Drive and you'd like to avoid this, please move them in manually before
                    selecting the folder.
                  </li>
                  <li>
                    <p>If you run multiple instances of
                      Home Assistant with this addon using the same Google Drive account, its recommended that you use a
                      different folder
                      for each instance. Otherwise they'll delete eachother's snapshots!</p>
                  </li>
                </ul>
                <p class="hide-for-custom-creds"><b>Note:</b> Google's authentication mechanisms require you to
                  select your folder through an external domain, which is where the link below will take you.
                  <a href="https://github.com/sabeechen/hassio-google-drive-backup/blob/master/hassio-google-drive-backup/AUTHENTICATION.md"
                    target="_blank">See here</a> for details if you'd like to know more about why.</p>
                <div class="card-action white-text">
                  <a href="#" onclick="chooseSnapshotFolder()" class="hide-for-custom-creds">Choose folder</a>
                  <a href="#" onclick="loadSettings()">Open settings</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card backup_folder_inaccessible" id="backup_folder_inaccessible">
          <div class="col s12 m12 l9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">sync_problem</i>
                  <span style="vertical-align: top;">Couldn't use your backup folder</span>
                </span>
                <p>The addon couldn't use the folder you chose for storing snapshots. The addon can't backup your
                  snapshots
                  until you resolve this. This can happen if:
                  <ul class="browser-default">
                  <li>The folder was deleted</li>
                  <li>You lost permissions on the folder</li> 
                  <li>You signed in with drive using different credentials</li>
                  <li>Something else made the folder unreadable</li>
                  </ul>
                </p>
                <p>
                  To resolve this, you can:
                </p>
                <ul class="browser-default">
                  <li class="hide-for-custom-creds">
                    <p>Use the link below to choose a new folder to store snapshots in.</p>
                  </li>
                  <li class="hide-for-default-creds">
                    <p>Open your <a href="#!" onclick="loadSettings()"><i class="material-icons"
                          style="display: inline; margin-right: 2px; vertical-align: middle; font-size: 15px">settings</i>add-on
                        settings</a> and, enter a valid "Snapshot Folder Id".</p>
                  </li>
                  <li>
                    <p>Open your <a href="#!" onclick="loadSettings()"><i class="material-icons"
                          style="display: inline; margin-right: 2px; vertical-align: middle; font-size: 15px">settings</i>add-on
                        settings</a> and deselect "Manually specify the snapshot folder". The addon will automatically
                      create a new folder for you.</p>
                  </li>
                  <li>
                    <p>If the folder still exists, you can restore access to it by the addon by ensuring that your
                      google account has access to it. The folder should be accessible from <a id="data_existing_url"
                        target="_blank">this link</a>. After doing so, click "sync now" below to try syncing again.</p>
                  </li>
                </ul>
                <p class="hide-for-custom-creds"><b>Note:</b> Google's authentication mechanisms require you to select
                  your folder through an
                  external domain, which is where the "choose folder" link below will take you.
                  <a href="https://github.com/sabeechen/hassio-google-drive-backup/blob/master/hassio-google-drive-backup/AUTHENTICATION.md"
                    target="_blank">See here</a> for details if you'd like to know more about why.</p>
                <div class="card-action white-text">
                  <a href="#" onclick="chooseSnapshotFolder()" class="hide-for-custom-creds">Choose new folder</a>
                  <a href="#" onclick="sync('backup_folder_inaccessible')">sync now</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card cancelled" id="cancelled">
          <div class="col s12 m12 l9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">pause</i>
                  <span style="vertical-align: top;">Backup is Paused</span>
                </span>
                <p>Sync was cancelled because you requested it.  The addon will not resume syncing for another hour unless you take action.</p>
                <br />
                <p>
                  Please note:
                </p>
                <ul class="browser-default">
                  <li>
                    <p>A pending snapshot can't be stopped once its started, because its creation is managed by Home Assistant.  Being "Paused" only stops the addon from creating new snapshots and syncing them with Google Drive.</p>
                  </li>
                  <li>
                    <p>You can resume by clicking the link below or just waiting.</p>
                  </li>
                </ul>
                <div class="card-action white-text">
                  <a href="#" onclick="sync('cancelled')">Resume</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card token_refresh_google_error" id="token_refresh_google_error">
          <div class="col s12 m9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">error</i>
                  <span style="vertical-align: top;">Couldn't Refresh Google Drive Credentials</span>
                </span>
                <p>
                  The addon was unable to refresh your credentials with Google Drive.  When it tried, Google said:
                </p>
                <pre>
                  <span id="data_from_google">(?)</span>
                </pre>
                <p>This can happen if:</p>
                <ul class="browser-default">
                  <li>The domain <a target="_blank" href="https://habackup.io">https://habackup.io</a>, which grants your credentials from Google Drive (<a target="_blank" href="https://github.com/sabeechen/hassio-google-drive-backup/blob/master/hassio-google-drive-backup/AUTHENTICATION.md">click here</a> to see why), is having trouble communicating with Google Drive.</li>
                  <li>Google Drive is experiencing a temporary outage.</li>
                  <li>Something else has gone wrong with your Google Drive credentials.</li>
                </ul>
                <p>Usually this problem will resolve on its own, but you can try:
                  <ul class="browser-default">
                    <li>Syncing again with the button below.  The addon will retry on its own periodically.</li>
                    <li><a href="reauthenticate">Re-authenticating</a> this add-on with Google
                      again. Its unlikely this will resolve the problem, but it also won't cause you to lose any of your data.</li>
                    <li>If the problem persists, <a onclick="bugReport()">file an issue on GitHub</a> to let the developer of this addon know about it.</li>
                  </ul>
                <div class="card-action white-text">
                  <a href="#" onclick="sync('token_refresh_google_error')">sync again</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card token_refresh_my_error" id="token_refresh_my_error">
          <div class="col s12 m9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">error</i>
                  <span style="vertical-align: top;">Couldn't Refresh Google Drive Credentials</span>
                </span>
                <p>
                  The addon was unable to refresh your credentials with Google Drive.  When it tried, https://habackup.io said:
                </p>
                <pre>
                  <span id="data_reason">(?)</span>
                </pre>
                <p>This can happen if:</p>
                <ul class="browser-default">
                  <li>The domain <a target="_blank" href="https://habackup.io">https://habackup.io</a>, which grants your credentials from Google Drive (<a target="_blank" href="https://github.com/sabeechen/hassio-google-drive-backup/blob/master/hassio-google-drive-backup/AUTHENTICATION.md">click here</a> to see why), is having some unexpected problems.</li>
                  <li>Something else has gone wrong with your Google Drive credentials.</li>
                </ul>
                <p>Usually this problem will resolve on its own, but you can try:
                  <ul class="browser-default">
                    <li>Syncing again with the button below.  The addon will retry on its own periodically.</li>
                    <li><a href="reauthenticate">Re-authenticating</a> this add-on with Google
                      again. Its unlikely this will resolve the problem, but it also won't cause you to lose any of your data.</li>
                    <li>If the problem persists, <a onclick="bugReport()">file an issue on GitHub</a> to let the developer of this addon know about it.</li>
                  </ul>
                <div class="card-action white-text">
                  <a href="#" onclick="sync('token_refresh_my_error')">sync again</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden error_card supervisor_connection" id="supervisor_connection">
          <div class="col s12 m9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">
                  <i class="material-icons" style="font-size: 50px; padding-right: 10px;">error</i>
                  <span style="vertical-align: top;">Unable to Reach Home Assistant Supervisor</span>
                </span>
                <p>
                  The addon was unable to connect to the Home Assistant Supervisor.  This addon requires the supervisor to be running to create 
                  snapshots, load configuration, etc.  Without the supervisor the addon will not be able to do anything useful.  Typically this 
                  should never happen, and indicates that something is wrong with your Home Assistant installation.
                </p>
                <p>To resolve this you can try:
                  <ul class="browser-default">
                    <li>Syncing again with the button below.  The addon will retry on its own periodically.</li>
                    <li>Restarting the machine that Home Assistant runs on.  Often this resolves transient problems the Home Assistant Supervisor might have.</li>
                    <li>If the problem persists, <a onclick="bugReport()">file an issue on GitHub</a> to let the developer of this addon know about it.</li>
                  </ul>
                <div class="card-action white-text">
                  <a href="#" onclick="sync('supervisor_connection')">sync again</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden" id="error_details_card">
          <div class="col s12 m9">
            <div class="card red darken-4">
              <div class="card-content white-text">
                <span class="card-title">Error details</span>
                <p id="error_details_paragraph" style="white-space: pre-wrap;font-family: monospace;"></p>
                <div class="card-action white-text">
                  <a target="_blank" onClick="$('#error_details_card').fadeOut(500)">Close</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden" id="error_reports_card">
          <div class="col s12 m9">
            <div class="card">
              <div class="card-content">
                <span class="card-title">Share Error Reports?</span>
                <p>If you select yes the text of unexpected exceptions this add-on produces will be sent to a server
                  maintained by the developer. This is completely optional, but helps give him a heads up for problems
                  with new releases and aids in providing better help messages when things go wrong. If you're unsure,
                  just select "No". You can always change this in the settings menu up on the top right of the page.</p>
                <div class="card-action white-text">
                  <a target="_blank" class="waves-effect waves-light btn" onClick="errorReports('true');">Yes</a>
                  <a target="_blank" class="waves-effect waves-light btn" onClick="errorReports('false');">No</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden" id="ingress_upgrade_card">
          <div class="col s12 m9">
            <div class="card">
              <div class="card-content">
                <span class="card-title">Use Ingress instead?</span>
                <p>The latest version of this add-on supports <a target="_blank"
                    href="https://www.home-assistant.io/blog/2019/04/15/hassio-ingress/">ingress</a>. Ingress allows
                  this web interface to be embeeded inside of Home Assistant, which is usually more secure because it
                  delegates authentication to the same mechanisms you've configured in Home Assistant (eg SSL and
                  username/password). Currently this interface is being served on an additional port outside of
                  Home Assistant which is less secure.</p>
                <br />
                <p><b>Select YES</b> to only use ingress to access this interface. This is recommended, as ingress is
                  almost always more secure.
                  In the future you can access this interface by following the "WEB UI" link from the add-on
                  installation page or embedding it in
                  your Home Assistant side-bar from the same place.</p>
                <br />
                <p><b>Select NO</b> to continue exposing a web interface on an open port with the SSL and authentication
                  settings you choose. The port, which defaults to 1627, can be changed form the add-on page in Home
                  Assistant.</p>
                <br />
                <p>You can change this option any time from the settings menu. No matter which you choose, the interface
                  will be available through ingress.</p>
                <br />
                <div class="card-action white-text">
                  <a target="_blank" class="waves-effect ha-blue waves-light btn"
                    onClick="exposeServer('false');">Yes</a>
                  <a target="_blank" class="waves-effect ha-blue waves-light btn" onClick="exposeServer('true');">No</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row default-hidden" id="restore_help_card">
          <div class="col s12 m9">
            <div class="card">
              <div class="card-content">
                <span class="card-title">Restore a Snapshot</span>
                <p>Snapshots must be restored through the supervisor Snapshots page. You can restore a snapshot by
                  navigating to
                  "Supervisor" &gt; "Snapshots" from the Home Assistant Web-UI,
                  or by click the button below to navigate there by a direct link. Depending on how you access the Home
                  Assistant Web-UI the direct link may not, so you'll just have to navigate there.</p>
                <br />
                <div class="card-action">
                  <a target="_blank" id="restore_hard_link" class="waves-effect ha-blue waves-light btn" href="">Open
                    Snapshots</a>
                  <a target="_blank" class="waves-effect ha-blue waves-light btn modal-close"
                    onClick="$('#restore_help_card').fadeOut(500)">Dismiss</a>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col m3">
            <div class="left container" style="margin-left: 15px">
              <h6>In Home Assistant:</h6>
            </div>
            <div class="left container ha_retain_label" style="margin-left: 15px">
              <h7 class="left"><span class="ha_retain_count"></span> saved indefinitely</h7>
            </div>
            <div class="right container">
              <div class="right">
                <h5 id="ha_snapshots" style="text-align: right;"></h5>
                <div id="free_space" style="text-align: right;" class="tooltipped"
                  data-tooltip="An estimate of the space available in your Home Assistant backup folder."></div>
              </div>
            </div>
            <div class="left container" style="margin-left: 15px">
              <h6>In Google Drive:</h6>
            </div>
            <div class="left container drive_retain_label" style="margin-left: 15px">
              <h7 class="left"><span class="drive_retain_count"></span> saved indefinitely</h7>
            </div>
            <div class="right container">
              <h5 class="right " id="drive_snapshots"></h5>
            </div>
            <div class="left container" style="margin-left: 15px">
              <h6>Last Snapshot:</h6>
            </div>
            <div class="right container">
              <h6 class="right " id="last_snapshot"></h6>
            </div>
            <div class="left container" style="margin-left: 15px">
              <h6>Next Snapshot:</h6>
            </div>
            <div class="right container">
              <h6 class="right " id="next_snapshot"></h6>
            </div>
          </div>
          <div class="col m1 hide-on-med-and-down"></div>
          <div class="col m8">
            <div>
              <div class='row default-hidden' id="no_snapshots_block">
                <div class='col s1'></div>
                <div class='col s2 valign-wrapper center'>
                  <i class='red-text text-darken-4 material-icons' style="font-size: 90px">block</i>
                </div>
                <div class='col s7 center valign-wrapper'>
                  <p>You don't have any snapshots in Google Drive or Home Assistant. Use the "Actions" menu up top
                    create a snapshot and start backing up.</p>
                </div>
              </div>
              <div id="snapshots_loading" class=row>
                <div class='col s1'></div>
                <div class='col s2 valign-wrapper center'>
                  <i class='material-icons' style="font-size: 90px">refresh</i>
                </div>
                <div class='col s7 center valign-wrapper'>
                  <p>Waiting for snapshots to load. If you don't see this go away soon, make sure the add-on is still
                    running. Info on this page may be stale until then.</p>
                </div>
              </div>
              <div id="snapshots">
              </div>
            </div>
            <div class="divider"></div>
          </div>
        </div>
      </div>
    </div>
  </main>
  <footer class="ha-blue page-footer">
    <div class="container">
      <div class="row">
        <div class="col l3 s12">
          <h5 class="accent-text">Connect</h5>
          <ul>
            <li><a class="accent-text" href="https://github.com/sabeechen/hassio-google-drive-backup">Project Github</a>
            </li>
            <li><a class="accent-text" href="https://github.com/sabeechen/hassio-google-drive-backup/issues">Issue
                Tracker</a></li>
            <li><a class="accent-text" href="https://materializecss.com">Materialize</a></li>
          </ul>
        </div>
        <div class="col l6 s12">
          <h5 class="accent-title">Who did this?</h5>
          <p class="accent-text">I'm an individual who works on projects like this in my spare time. If you
            like it and would like to support me, you can star my projects on <a
              href="https://github.com/sabeechen" class="accent-text">Github</a> or just gimme money at
            <a class="bmc-button" target="_blank" href="https://www.buymeacoffee.com/sabeechen"><img src="static/images/bmc.svg" alt="Support me"><span>Buy me a coffee</span></a></p>
        </div>
      </div>
      <div class="container left accent-text">
        © 2020 Stephen Beechen
      </div>
    </div>
  </footer>
</body>

</html>